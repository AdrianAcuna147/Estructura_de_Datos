import random
import time
import sys

# Configuraci√≥n de la matriz MASIVA
NUM_ALUMNOS = 100000  # 100,000 alumnos (FILAS)
NUM_MATERIAS = 6       # 6 materias (COLUMNAS)

# Nombres de las materias
NOMBRES_MATERIAS = [
    "Matem√°ticas",
    "F√≠sica",
    "Qu√≠mica",
    "Historia",
    "Literatura",
    "Ingl√©s"
]

print("\n" + "‚ïî" + "‚ïê"*70 + "‚ïó")
print("‚ïë" + " "*12 + "üéì SISTEMA DE CALIFICACIONES - CARGA ULTRA MASIVA" + " "*9 + "‚ïë")
print("‚ïö" + "‚ïê"*70 + "‚ïù")
print(f"\n  üìä Configuraci√≥n:")
print(f"     ‚Ä¢ Alumnos (filas):   {NUM_ALUMNOS:,}")
print(f"     ‚Ä¢ Materias (columnas): {NUM_MATERIAS}")
print(f"     ‚Ä¢ Total de calificaciones: {NUM_ALUMNOS * NUM_MATERIAS:,}")
print("\n  ‚è≥ Iniciando carga de datos...")
print("‚îÄ"*72)

# MEDIR TIEMPO DE CREACI√ìN DE LA MATRIZ
tiempo_inicio = time.time()

# Crear matriz: 100,000 alumnos (filas) x 6 materias (columnas)
calificaciones = []

progreso_anterior = -1
for i in range(NUM_ALUMNOS):
    # Mostrar progreso cada 1%
    porcentaje = int((i / NUM_ALUMNOS) * 100)
    if porcentaje != progreso_anterior and porcentaje % 5 == 0:
        print(f"  Generando datos... {porcentaje:3d}% completado ({i:,}/{NUM_ALUMNOS:,} alumnos)")
        progreso_anterior = porcentaje
    
    # Crear fila con 6 calificaciones
    fila = [random.randint(1, 10) for _ in range(NUM_MATERIAS)]
    calificaciones.append(fila)

tiempo_fin = time.time()
tiempo_total = tiempo_fin - tiempo_inicio

# Calcular tama√±o en memoria (aproximado)
tama√±o_bytes = sys.getsizeof(calificaciones)
for fila in calificaciones[:1000]:
    tama√±o_bytes += sys.getsizeof(fila)
    tama√±o_bytes += sum(sys.getsizeof(item) for item in fila)
tama√±o_bytes = tama√±o_bytes * (NUM_ALUMNOS / 1000)
tama√±o_mb = tama√±o_bytes / (1024 * 1024)

print("‚îÄ"*72)
print("\n" + "‚ïî" + "‚ïê"*70 + "‚ïó")
print("‚ïë" + " "*23 + "‚úÖ CARGA COMPLETADA" + " "*28 + "‚ïë")
print("‚ïö" + "‚ïê"*70 + "‚ïù")

print("\nüìà ESTAD√çSTICAS DE RENDIMIENTO:")
print("‚îå" + "‚îÄ"*70 + "‚îê")
print(f"‚îÇ Tiempo de carga total:         {tiempo_total:10.4f} segundos           ‚îÇ")
print(f"‚îÇ Calificaciones generadas:      {NUM_ALUMNOS * NUM_MATERIAS:10,} elementos         ‚îÇ")
print(f"‚îÇ Velocidad de generaci√≥n:       {(NUM_ALUMNOS * NUM_MATERIAS)/tiempo_total:10,.0f} calif./segundo    ‚îÇ")
print(f"‚îÇ Tama√±o aproximado en memoria:  {tama√±o_mb:10.2f} MB                  ‚îÇ")
print(f"‚îÇ Estructura:                    {NUM_ALUMNOS:,} filas √ó {NUM_MATERIAS} columnas    ‚îÇ")
print("‚îî" + "‚îÄ"*70 + "‚îò")

def visualizar_tabla_completa():
    """Visualiza TODOS los 100,000 alumnos"""
    print("\n" + "="*100)
    print(f"TABLA COMPLETA DE CALIFICACIONES - TODOS LOS {NUM_ALUMNOS:,} ALUMNOS")
    print("="*100)
    print("\n‚è≥ Generando visualizaci√≥n completa...")
    
    tiempo_inicio_viz = time.time()
    
    # Encabezado
    print("\n‚îå" + "‚îÄ"*12 + "‚î¨", end="")
    for i in range(NUM_MATERIAS):
        print("‚îÄ"*15 + ("‚î¨" if i < NUM_MATERIAS-1 else "‚îê"), end="")
    print()
    
    # Nombres de materias
    print("‚îÇ ALUMNO #   ‚îÇ", end="")
    for materia in range(NUM_MATERIAS):
        print(f" {NOMBRES_MATERIAS[materia]:13} ‚îÇ", end="")
    print()
    
    # L√≠nea separadora principal
    print("‚îú" + "‚îÄ"*12 + "‚îº", end="")
    for i in range(NUM_MATERIAS):
        print("‚îÄ"*15 + ("‚îº" if i < NUM_MATERIAS-1 else "‚î§"), end="")
    print()
    
    # MOSTRAR TODOS LOS ALUMNOS
    contador_progreso = 0
    for alumno in range(NUM_ALUMNOS):
        # Mostrar progreso cada 10,000 alumnos
        if alumno % 10000 == 0 and alumno > 0:
            contador_progreso += 1
            porcentaje = (alumno / NUM_ALUMNOS) * 100
            print(f"‚îÇ {'':10} ‚îÇ Progreso: {porcentaje:5.1f}% completado ({alumno:,}/{NUM_ALUMNOS:,} alumnos)..." + " "*34 + "‚îÇ")
        
        # Datos del alumno
        print(f"‚îÇ {alumno:10,} ‚îÇ", end="")
        for materia in range(NUM_MATERIAS):
            print(f" {calificaciones[alumno][materia]:2}/10          ‚îÇ", end="")
        print()
        
        # L√≠nea separadora cada alumno (solo cada 1000 para optimizar)
        if alumno < NUM_ALUMNOS - 1 and alumno % 1000 == 999:
            print("‚îú" + "‚îÄ"*12 + "‚îº", end="")
            for i in range(NUM_MATERIAS):
                print("‚îÄ"*15 + ("‚îº" if i < NUM_MATERIAS-1 else "‚î§"), end="")
            print()
    
    # L√≠nea final
    print("‚îî" + "‚îÄ"*12 + "‚î¥", end="")
    for i in range(NUM_MATERIAS):
        print("‚îÄ"*15 + ("‚î¥" if i < NUM_MATERIAS-1 else "‚îò"), end="")
    print()
    
    tiempo_fin_viz = time.time()
    tiempo_viz = tiempo_fin_viz - tiempo_inicio_viz
    
    print("\n" + "="*100)
    print(f"‚úÖ Visualizaci√≥n completa generada en {tiempo_viz:.2f} segundos")
    print(f"üìä Se mostraron {NUM_ALUMNOS:,} alumnos √ó {NUM_MATERIAS} materias")
    print("="*100)

def visualizar_tabla_paginada(alumnos_por_pagina=100):
    """Visualiza la tabla en p√°ginas de N alumnos"""
    total_paginas = (NUM_ALUMNOS + alumnos_por_pagina - 1) // alumnos_por_pagina
    
    print(f"\nüìÑ VISUALIZACI√ìN PAGINADA: {alumnos_por_pagina} alumnos por p√°gina")
    print(f"üìä Total de p√°ginas: {total_paginas:,}")
    
    for pagina in range(total_paginas):
        inicio = pagina * alumnos_por_pagina
        fin = min((pagina + 1) * alumnos_por_pagina, NUM_ALUMNOS)
        
        print("\n" + "="*100)
        print(f"P√ÅGINA {pagina + 1:,}/{total_paginas:,} - Alumnos {inicio:,} al {fin-1:,}")
        print("="*100)
        
        # Encabezado
        print("\n‚îå" + "‚îÄ"*12 + "‚î¨", end="")
        for i in range(NUM_MATERIAS):
            print("‚îÄ"*15 + ("‚î¨" if i < NUM_MATERIAS-1 else "‚îê"), end="")
        print()
        
        # Nombres de materias
        print("‚îÇ ALUMNO #   ‚îÇ", end="")
        for materia in range(NUM_MATERIAS):
            print(f" {NOMBRES_MATERIAS[materia]:13} ‚îÇ", end="")
        print()
        
        # L√≠nea separadora
        print("‚îú" + "‚îÄ"*12 + "‚îº", end="")
        for i in range(NUM_MATERIAS):
            print("‚îÄ"*15 + ("‚îº" if i < NUM_MATERIAS-1 else "‚î§"), end="")
        print()
        
        # Datos de la p√°gina
        for alumno in range(inicio, fin):
            print(f"‚îÇ {alumno:10,} ‚îÇ", end="")
            for materia in range(NUM_MATERIAS):
                print(f" {calificaciones[alumno][materia]:2}/10          ‚îÇ", end="")
            print()
            
            if alumno < fin - 1:
                print("‚îú" + "‚îÄ"*12 + "‚îº", end="")
                for i in range(NUM_MATERIAS):
                    print("‚îÄ"*15 + ("‚îº" if i < NUM_MATERIAS-1 else "‚î§"), end="")
                print()
        
        # L√≠nea final
        print("‚îî" + "‚îÄ"*12 + "‚î¥", end="")
        for i in range(NUM_MATERIAS):
            print("‚îÄ"*15 + ("‚î¥" if i < NUM_MATERIAS-1 else "‚îò"), end="")
        print()
        
        # Pausa entre p√°ginas (excepto en la √∫ltima)
        if pagina < total_paginas - 1:
            respuesta = input(f"\n‚û°Ô∏è  Presiona ENTER para siguiente p√°gina, 'q' para salir: ")
            if respuesta.lower() == 'q':
                print(f"\n‚è∏Ô∏è  Visualizaci√≥n detenida en p√°gina {pagina + 1}/{total_paginas:,}")
                break

def visualizar_rango_alumnos(inicio, fin):
    """Visualiza un rango espec√≠fico de alumnos"""
    if inicio < 0 or fin > NUM_ALUMNOS or inicio >= fin:
        print(f"‚ùå ERROR: Rango inv√°lido. Debe ser 0 <= inicio < fin <= {NUM_ALUMNOS:,}")
        return
    
    print("\n" + "="*100)
    print(f"RANGO DE ALUMNOS: {inicio:,} al {fin-1:,} ({fin-inicio:,} alumnos)")
    print("="*100)
    
    # Encabezado
    print("\n‚îå" + "‚îÄ"*12 + "‚î¨", end="")
    for i in range(NUM_MATERIAS):
        print("‚îÄ"*15 + ("‚î¨" if i < NUM_MATERIAS-1 else "‚îê"), end="")
    print()
    
    # Nombres de materias
    print("‚îÇ ALUMNO #   ‚îÇ", end="")
    for materia in range(NUM_MATERIAS):
        print(f" {NOMBRES_MATERIAS[materia]:13} ‚îÇ", end="")
    print()
    
    # L√≠nea separadora
    print("‚îú" + "‚îÄ"*12 + "‚îº", end="")
    for i in range(NUM_MATERIAS):
        print("‚îÄ"*15 + ("‚îº" if i < NUM_MATERIAS-1 else "‚î§"), end="")
    print()
    
    # Datos
    for alumno in range(inicio, fin):
        print(f"‚îÇ {alumno:10,} ‚îÇ", end="")
        for materia in range(NUM_MATERIAS):
            print(f" {calificaciones[alumno][materia]:2}/10          ‚îÇ", end="")
        print()
        
        if alumno < fin - 1:
            print("‚îú" + "‚îÄ"*12 + "‚îº", end="")
            for i in range(NUM_MATERIAS):
                print("‚îÄ"*15 + ("‚îº" if i < NUM_MATERIAS-1 else "‚î§"), end="")
            print()
    
    # L√≠nea final
    print("‚îî" + "‚îÄ"*12 + "‚î¥", end="")
    for i in range(NUM_MATERIAS):
        print("‚îÄ"*15 + ("‚î¥" if i < NUM_MATERIAS-1 else "‚îò"), end="")
    print()
    print("="*100)

def menu_principal():
    """Men√∫ interactivo del sistema"""
    while True:
        print("\n" + "‚ïî" + "‚ïê"*70 + "‚ïó")
        print("‚ïë" + " "*17 + "üéì SISTEMA DE GESTI√ìN ULTRA MASIVA" + " "*19 + "‚ïë")
        print("‚ïö" + "‚ïê"*70 + "‚ïù")
        print(f"\n  üìä Sistema: {NUM_ALUMNOS:,} alumnos (filas) √ó {NUM_MATERIAS} materias (columnas)")
        print(f"  üíæ Total: {NUM_ALUMNOS * NUM_MATERIAS:,} calificaciones en memoria")
        print("\n  OPCIONES DE VISUALIZACI√ìN:")
        print("  [1] Ver TODA la tabla completa (100,000 alumnos) ‚ö†Ô∏è  Toma tiempo")
        print("  [2] Ver tabla paginada (100 alumnos por p√°gina)")
        print("  [3] Ver tabla paginada (1,000 alumnos por p√°gina)")
        print("  [4] Ver rango espec√≠fico de alumnos")
        print("  [5] Ver primeros 100 alumnos")
        print("  [6] Ver √∫ltimos 100 alumnos")
        print("  [7] Ver alumnos 49,900 a 50,100 (alrededor del 50,000)")
        print("  [8] Salir")
        print("‚îÄ"*72)
        
        opcion = input("  Selecciona una opci√≥n (1-8): ").strip()
        
        if opcion == "1":
            confirmacion = input(f"\n‚ö†Ô∏è  Esto mostrar√° {NUM_ALUMNOS:,} l√≠neas. ¬øContinuar? (s/n): ")
            if confirmacion.lower() == 's':
                visualizar_tabla_completa()
            else:
                print("‚ùå Visualizaci√≥n cancelada")
            input("\nPresiona ENTER para continuar...")
            
        elif opcion == "2":
            visualizar_tabla_paginada(100)
            
        elif opcion == "3":
            visualizar_tabla_paginada(1000)
            
        elif opcion == "4":
            try:
                inicio = int(input(f"  Desde qu√© alumno? (0-{NUM_ALUMNOS-1:,}): "))
                fin = int(input(f"  Hasta qu√© alumno? ({inicio+1}-{NUM_ALUMNOS:,}): "))
                visualizar_rango_alumnos(inicio, fin)
            except ValueError:
                print("‚ùå Error: Ingresa n√∫meros v√°lidos")
            input("\nPresiona ENTER para continuar...")
            
        elif opcion == "5":
            visualizar_rango_alumnos(0, 100)
            input("\nPresiona ENTER para continuar...")
            
        elif opcion == "6":
            visualizar_rango_alumnos(NUM_ALUMNOS - 100, NUM_ALUMNOS)
            input("\nPresiona ENTER para continuar...")
            
        elif opcion == "7":
            visualizar_rango_alumnos(49900, 50100)
            input("\nPresiona ENTER para continuar...")
            
        elif opcion == "8":
            print("\n" + "‚ïî" + "‚ïê"*70 + "‚ïó")
            print("‚ïë" + " "*26 + "üëã ¬°Hasta luego!" + " "*29 + "‚ïë")
            print("‚ïö" + "‚ïê"*70 + "‚ïù\n")
            break
        else:
            print("‚ùå Opci√≥n no v√°lida.")

# PROGRAMA PRINCIPAL
if __name__ == "__main__":
    # Mostrar primeros 20 alumnos como ejemplo
    print("\n" + "‚îÄ"*72)
    print("üìù VISTA PREVIA: Primeros 20 alumnos")
    print("‚îÄ"*72)
    visualizar_rango_alumnos(0, 20)
    
    input("\nPresiona ENTER para ir al men√∫...")
    menu_principal()
